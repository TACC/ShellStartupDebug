#!/bin/bash
# -*- shell-script -*-

DBG_ECHO()
{
  local arg
  arg=$(echo "$1" | tr -d ' ')
  if [ "$arg"  = "}" ]; then
    SHELL_STARTUP_DEBUG_T1=$(@PKG@/libexec/epoch)
    SHELL_STARTUP_DEBUG_RT=$(builtin echo "$SHELL_STARTUP_DEBUG_T1 - $SHELL_STARTUP_DEBUG_T0" | bc -q )
    echo "$@" " Time = $SHELL_STARTUP_DEBUG_RT"
  else
    echo "$@"
  fi
}

DBG_INDENT_FUNC()
{
  true
}

if [ -f $HOME/.init.sh ]; then
  . $HOME/.init.sh
  export SHELL_STARTUP_DEBUG_T0=$(@PKG@/libexec/epoch)
fi


if [ -n "$SHELL_STARTUP_DEBUG" ]; then
  DBG_INDENT_FUNC()
  {
    eval `@PKG@/libexec/DBG_INDENT_cmd -s bash "$@"`;
    DBG_INDENT=$(printf $DBG_INDENT_FMT "$DBG_INDENT_ARG");
  }   
  if [ -n "$SHELL_STARTUP_DEBUG" ] && [ $SHELL_STARTUP_DEBUG -gt 2 ]; then
    DBG_ECHO()
    {
      @PKG@/libexec/ECHO_cmd "$@"
    }
  fi
fi
